!function(){const e=document.getElementsByTagName("main")[0],t=0,n=1,a={EASY:{name:"easy",height:8,width:10,mines:10},MID:{name:"mid",height:14,width:18,mines:40},HARD:{name:"hard",height:20,width:24,mines:99}},l="EASY",s={1:"#1976d2",2:"#388e3c",3:"#d32f2f",4:"#7b1fa2",5:"#ff8f00",6:"#0097a7",flag:"red",mine:"black"},o=document.createElement("div");o.classList.add("toolbar");const i=document.createElement("select");i.onchange=()=>{d.changeDif(i.value)};for(const[e,t]of Object.entries(a)){const n=document.createElement("option");n.value=e,n.textContent=t.name,n.selected=e==l,i.appendChild(n)}o.appendChild(i);const r=document.createElement("span");r.classList.add("mine-counter"),o.appendChild(r);const c=document.createElement("span");c.textContent=0,c.classList.add("time-counter"),o.appendChild(c),e.appendChild(o);const d=function(){let o,{width:d,height:m,mines:h}=a[l],u=0,p=[],f=!0;return{initGame(){o=setInterval((()=>{u++,c.textContent=u}),1e3);const n=document.createElement("div");n.classList.add("grid"),n.oncontextmenu=()=>!1,document.documentElement.style.setProperty("--nbColumns",d),r.textContent=h;for(let e=0;e<m;e++){const a=[];for(let l=0;l<d;l++){let s=document.createElement("div");s.onmousedown=this.clickCallback(e,l),(e+l)%2==0&&s.classList.add("alternate");const o={status:t,marked:!1,unraveled:!1,element:s};n.appendChild(s),a.push(o)}p.push(a)}e.appendChild(n),this.placeMines()},placeMines(){let e=0;for(;e<h;){const t=Math.floor(Math.random()*m),a=Math.floor(Math.random()*d),l=p[t][a];l.status!==n&&(l.status=n,e++)}},clickCallback(e,t){return a=>{if(a.preventDefault(),!f)return;const l=p[e][t];if(!l.unraveled){if(0===a.button){if(l.marked)return;l.status===n?this.lostGame():(l.unraveled=!0,this.unravel(e,t))}else 2===a.button&&(l.marked=!l.marked,l.marked?(l.element.textContent="âš‘",l.element.style.color=s.flag,h--):(l.element.textContent="",h++),r.textContent=h);this.checkWin(),!1===f&&clearInterval(o)}}},unravel(e,t){const a=p[e][t];a.unraveled=!0;let l=0;for(let a=e-1;a<=e+1;a++)for(let s=t-1;s<=t+1;s++)a===e&&s===t||a<0||a>=m||s<0||s>=d||p[a][s].status===n&&l++;if(a.element.classList.add("open"),l>0)a.element.textContent=l,a.element.style.color=s[l];else for(let a=e-1;a<=e+1;a++)for(let l=t-1;l<=t+1;l++)a===e&&l===t||a<0||a>=m||l<0||l>=d||p[a][l].status===n||p[a][l].marked||p[a][l].unraveled||this.unravel(a,l)},lostGame(){for(let e=0;e<p.length;e++)for(let t=0;t<p[e].length;t++){const a=p[e][t];a.status!==n||a.marked?a.status!==n&&a.marked&&(a.element.textContent="x"):a.element.textContent="*"}this.endScreen(!1)},checkWin(){let e=0;for(let t=0;t<p.length;t++)for(let a=0;a<p[t].length;a++){const l=p[t][a];l.status===n&&l.marked||l.unraveled||e++}h===e&&this.endScreen(!0)},changeDif(e){({width:d,height:m,mines:h}=a[e]),this.reset()},endScreen(e=!1){f=!1,clearInterval(o);const t=localStorage.getItem("pb");e&&(!t||isNaN(parseInt(t))||u<t)&&localStorage.setItem("pb",u),e||(u="");const n=document.createElement("dialog");n.innerHTML=`<div><span>Run: ${u}</span><span>Pb: ${t??"-"}</span></div>`;const a=document.createElement("button");a.innerHTML='<img src="https://www.gstatic.com/images/icons/material/system/2x/refresh_white_24dp.png">Play Again',a.onclick=()=>{n.remove(),this.changeDif(i.value)},n.appendChild(a),document.body.appendChild(n),setTimeout((()=>{n.showModal()}),2500)},reset(){e.querySelector(".grid").remove(),p=[],f=!0,u=0,clearInterval(o),c.textContent=0,this.initGame()}}}();d.initGame()}();